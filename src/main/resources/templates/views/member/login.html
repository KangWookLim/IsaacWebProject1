<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layout/main_layout}">

<th:block layout:fragment="css">
	<link rel="stylesheet" th:href="@{/css/member/login.css}">
</th:block>

<div layout:fragment="content">
	<div class="wrap">
	    <div class="log">
	        <h2>Login Page</h2>
	        <div class="id">
	            <label for="userId">ID </label>
	            <input type="text"  id="userId" name="userId" placeholder="아이디를 입력하십시오.">
	        </div>
	        <div class="pw">
	            <label for="userPasswd">PW </label>
	            <input type="password"  id="userPasswd" name="userPasswd" placeholder="패스워드를 입력하십시오.">
	        </div>
	        <div class="loginBtn" id="btn">
	            <button type="button" class="loginBtn" id="loginBtn">Login</button>
	
	            <a th:href="@{/views/member/join.html}" style="margin-top: 10%">회원가입 하시겠습니까?</a>
	        </div>
	
	    </div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-3.6.4.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css2?family=Blinker:wght@100;300&display=swap" rel="stylesheet">
<script>
function initEvt() {

    $('#loginBtn').on('click', function(evt){
        login();
    });
}

function validated(){
    const userId = $('#userId');
    const userPasswd = $('#userPasswd');

    if($.trim(userId.val()).length === 0) {
        alert('아이디를 입력하십시오.');
        userId.focus();
        return false;
    }

    if($.trim(userPasswd.val()).length === 0) {
        alert('패스워드를 입력하십시오.');
        userPasswd.focus();
        return false;
    }

    return true;
}

function login() {

    if(validated()) {
        const dataParam = {
            userId : $('#userId').val(),
            userPasswd : $('#userPasswd').val()
        }

        $.ajax({
            url : '/login',
            type : 'post',
            dataType : 'json',
            data : dataParam
        }).done(function(data){
            if(data.resultCode === 200) {
                location.href ="../../../../../../build/generated/sources/annotationProcessor/java/main";
            }else {
                alert('아이디 또는 패스워드를 확인하십시오.');
                return false;
            }
        }).fail(function(xhr, status, error){
            alert('에러코드 : ' + xhr.status);
        });

    }

}

$(document).ready(function(){
    initEvt();
});
</script>
</html>